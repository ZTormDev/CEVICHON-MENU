const productos = [

    // CEVICHES CAMARON O SALMON O MACHA  
    {
      nombre: 'Cevichón',
      tamaño: '300g', 
      imagen: '/ceviches/ceviche300g.png',
      descripcionCorta: 'Elige entre Camarón, Salmón o Macha.',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$4.500',
      precioActual: '$3.500',
      seleccion: 'si',
      tipoSeleccion: ['Camarón', 'Salmón', 'Macha'],
      cantidad: '1'
    },
    {
      nombre: 'Cevichón',
      tamaño: '500g', 
      imagen: '/ceviches/ceviche1kg.png',
      descripcionCorta: 'Elige entre Camarón, Salmón o Macha.',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$7.500',
      precioActual: '$6.000',
      seleccion: 'si',
      tipoSeleccion: ['Camarón', 'Salmón', 'Macha'],
      cantidad: '1'
    },
    {
      nombre: 'Cevichón',
      tamaño: '1kg', 
      imagen: '/ceviches/ceviche21kg.png',
      descripcionCorta: 'Elige entre Camarón, Salmón o Macha.',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$11.500',
      precioActual: '$10.500',
      seleccion: 'si',
      tipoSeleccion: ['Camarón', 'Salmón', 'Macha'],
      cantidad: '1'
    },


    // CEVICHES CAMARON Y SALMON
    {
      nombre: 'Cevichón',
      tamaño: '300g', 
      imagen: '/ceviches/ceviche300g-salmoncamaron.png',
      descripcionCorta: 'Camarón y Salmón.',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$5.000',
      precioActual: '$4.000',
      cantidad: '1'
    },
    {
      nombre: 'Cevichón',
      tamaño: '500g', 
      imagen: '/ceviches/ceviche500g-camaronsalmon.png',
      descripcionCorta: 'Camarón y Salmón.',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$7.500',
      precioActual: '$6.500',
      cantidad: '1'
    },
    {
      nombre: 'Cevichón',
      tamaño: '1kg', 
      imagen: '/ceviches/ceviche1kg-camaronsalmon.png',
      descripcionCorta: 'Camarón y Salmón.',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$13.000',
      precioActual: '$12.000',
      cantidad: '1'
    },


    // CEVICHES MACHA SALMON O MACHA CAMARON
    {
      nombre: 'Cevichón',
      tamaño: '300g', 
      imagen: '/ceviches/ceviche300g-machasalmonomachacamaron.png',
      descripcionCorta: 'Elije entre Macha y Salmón o Macha y Camarón',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$5.000',
      precioActual: '$4.000',
      seleccion: 'si',
      tipoSeleccion: ['Macha y Salmon','Macha y Camaron'],
      cantidad: '1'
    },
    {
      nombre: 'Cevichón',
      tamaño: '500g', 
      imagen: '/ceviches/ceviche.jpg',
      descripcionCorta: 'Elije entre Macha y Salmón o Macha y Camarón',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$7.500',
      precioActual: '$6.500',
      seleccion: 'si',
      tipoSeleccion: ['Macha y Salmon','Macha y Camaron'],
      cantidad: '1'
    },
    {
      nombre: 'Cevichón',
      tamaño: '1kg', 
      imagen: '/ceviches/ceviche21kg.png',
      descripcionCorta: 'Elije entre Macha y Salmón o Macha y Camarón',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$13.000',
      precioActual: '$12.000',
      seleccion: 'si',
      tipoSeleccion: ['Macha y Salmon','Macha y Camaron'],
      cantidad: '1'
    },


    // CEVICHES SALMON CAMARON Y MACHA || TRILOGIA MARINA
    {
      nombre: 'Trilogia Marina',
      tamaño: '300g', 
      imagen: '/ceviches/ceviche300g-trilogiamarina.png',
      descripcionCorta: 'Salmon, Camaron y Macha',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$5.500',
      precioActual: '$4.500',
      cantidad: '1'
    },
    {
      nombre: 'Trilogia Marina',
        tamaño: '500g', 
        imagen: '/ceviches/ceviche500g-trilogiamarina.png',
        descripcionCorta: 'Salmon, Camaron y Macha',
        descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
        precioAnterior: '$8.500',
        precioActual: '$7.500',
        cantidad: '1'
    },
    {
      nombre: 'Trilogia Marina',
      tamaño: '1kg', 
      imagen: '/ceviches/ceviche1kg-trilogiamarina.png',
      descripcionCorta: 'Salmon, Camaron y Macha',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$14.000',
      precioActual: '$13.000',
      cantidad: '1'
    },



    // AGREGADOSSSSS
    {
      nombre: 'Tostadas',
      tamaño: '3 uds', 
      imagen: '/agregados/tostadas.png',
      descripcionCorta: 'Tostadas de oregano y mantequilla',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$2.000',
      precioActual: '$1.000',
      cantidad: '1'
    },
    {
      nombre: 'Salsa de Ajo',
      tamaño: '1 uds', 
      imagen: '/agregados/salsadeajo.png',
      descripcionCorta: '',
      descripcion: 'Cevichon Macha, Camaron, Salmon, con maiz/choclo, pimenton verde y un poco de aji, mas unas 3 tostadas de oregano y mantequilla.',
      precioAnterior: '$1.000',
      precioActual: '$500',
      cantidad: '1'
    },
];



const ItemPreviewContainer = document.getElementById('product-preview-container');
const ItemPreview = document.getElementById('product-preview');

const productPreviewTitle = document.querySelector('.product-preview-title');
const productPreviewImage = document.querySelector('.product-preview-image');
const productPreviewDetails = document.querySelector('.product-preview-details');
const productPreviewPriceAnterior = document.querySelector('.product-preview-price-anterior');
const productPreviewPrice = document.querySelector('.product-preview-price');
const productPreviewPedirButton = document.querySelector('.pedir-button');

const seleccionContainer = document.querySelector('.seleccion-container');
const seleccionButtons = document.querySelector('.seleccion-buttons');

const cantidadText = document.querySelector('.cantidad');
const sumarButton = document.querySelector('.sumar');
const restarButton = document.querySelector('.restar');

function generarProductos() {
    const productosContainer = document.querySelector('.productos-container');
  
    productos.forEach((producto, index) => {
      const article = document.createElement('article');
      article.onclick = () => mostrarDetalleProducto(producto);

      article.id = `producto-${index + 1}`;
  
      article.innerHTML = `
        <div class='image-container'>
            <img class='imagenProducto' src="./assets/${producto.imagen}" alt="${producto.nombre}" />
        </div>
        <div class='product-details'>
            <div class="text-details">
                <h2 class='nombreProducto'>${producto.nombre} <p class="tamaño-ceviche">${producto.tamaño}</p></h2>
                <p>${producto.descripcionCorta}</p>
            </div>
            <div class='precio-container'>
                <p class="precio-anterior">${producto.precioAnterior}</p>
                <p class='precioProducto'>${producto.precioActual}</p>
            </div>
        </div>
      `;
  
      productosContainer.appendChild(article);
    });
  }

  // Función para aumentar la cantidad
  function sumar(producto) {
    let cantidad = parseInt(cantidadText.innerHTML);
    cantidad++;
    cantidadText.innerHTML = cantidad;
    // Actualizar la cantidad en el objeto de producto
    producto.cantidad = cantidad.toString();
    // Actualizar el enlace del botón "Pedir" con la nueva cantidad
    actualizarEnlacePedir(producto);
  }

  // Función para disminuir la cantidad
  function restar(producto) {
    let cantidad = parseInt(cantidadText.innerHTML);
    if (cantidad > 1) {
        cantidad--;
        cantidadText.innerHTML = cantidad;
        // Actualizar la cantidad en el objeto de producto
        producto.cantidad = cantidad.toString();
        // Actualizar el enlace del botón "Pedir" con la nueva cantidad
        actualizarEnlacePedir(producto);
    }
  }

  // Función para actualizar el enlace del botón "Pedir" con la cantidad seleccionada
  function actualizarEnlacePedir(producto) {
    let cantidad = parseInt(cantidadText.innerHTML);

    let precioProducto = producto.precioActual.replace(/\./g, '').replace('$', '');

    let total = precioProducto * cantidad;
    let precioTotalConPuntos = total.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');

    let mensajeCantidad = producto.seleccion === 'si' ? `Seleccion: *${seleccionButtons.querySelector('.active').textContent}*, ` : ``;
    productPreviewPedirButton.setAttribute('href', `https://wa.me/56963360528?text=Hola, este es mi pedido: *${producto.nombre}* *${producto.tamaño}*, Cantidad: *${cantidad}*, ${mensajeCantidad}Total: *$${precioTotalConPuntos}*`);
  }



  function mostrarDetalleProducto(producto) {
    productPreviewTitle.innerHTML = `${producto.nombre} <p class="preview-tamaño-ceviche">${producto.tamaño}</p>`;
    productPreviewImage.src = `./assets/${producto.imagen}`;
    productPreviewDetails.innerHTML = producto.descripcion;
    productPreviewPriceAnterior.innerHTML = producto.precioAnterior;
    productPreviewPrice.innerHTML = producto.precioActual;
    
    // Aquí actualizamos el enlace del botón "Pedir" con la cantidad seleccionada
    productPreviewPedirButton.setAttribute('href', `https://wa.me/56963360528?text=Hola, este es mi pedido: *${producto.nombre}* *${producto.tamaño}*, Cantidad: *${cantidadText.innerHTML}*, Precio: *${producto.precioActual * producto.cantidad}*`);

    cantidadText.innerHTML = `${producto.cantidad}`;
    sumarButton.onclick = () => sumar(producto);
    restarButton.onclick = () => restar(producto);

    ItemPreviewContainer.classList.remove('hidden');
    ItemPreview.classList.add('enterAnimation');


    if(producto.seleccion == 'si') {
      seleccionContainer.classList.remove('hidden')

      // Limpiamos el contenedor antes de agregar nuevos botones
      seleccionButtons.innerHTML = '';

      producto.tipoSeleccion.forEach(tipo => {
        const button = document.createElement('button');
        button.classList.add('seleccion-button');
        button.textContent = tipo;
        button.onclick = () => {
            // Iterar sobre todos los botones dentro de seleccionButtons
            seleccionButtons.querySelectorAll('button').forEach(btn => {
                // Eliminar la clase 'active' de cada botón
                btn.classList.remove('active');
            });
            // Agregar la clase 'active' al botón actual
            button.classList.add('active');
            // Actualizar el enlace del botón "Pedir" con la nueva selección
            productPreviewPedirButton.setAttribute('href', `https://wa.me/56963360528?text=Hola, este es mi pedido: *${producto.nombre}* *${producto.tamaño}*, Seleccion: *${tipo}*, Cantidad: *${cantidadText.innerHTML}*, Precio: *${producto.precioActual}*`);
        };
        seleccionButtons.appendChild(button);
    });
    }
    else {
      seleccionContainer.classList.add('hidden')
    }

  }

  function closeItemPreview() {
    ItemPreviewContainer.classList.add('hidden');
    ItemPreview.classList.remove('enterAnimation')
  }

window.onload = generarProductos;
